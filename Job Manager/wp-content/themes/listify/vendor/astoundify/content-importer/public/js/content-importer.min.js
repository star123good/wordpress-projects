!function(a,t){var e=a(window),s=s||{};s.importRunning=!1,s.$div=a("#astoundify-ci"),s.beforeUnload=function(){if(s.importRunning)return"Please do not leave while an import is in progress."},s.stageImport=function(t){_.each(t,function(t,e){var n=t.length;0===n?a("#import-type-"+e).hide():(s.typeElement(e,"spinner").addClass("is-active"),s.typeElement(e,"processed").text(0),s.typeElement(e,"total").text(n))})},s.runIterateImport=function(t,e){a("#import-status").html(""),a("#import-errors").html(""),s.importRunning=!0;var n=a.Deferred().resolve(),o=[];_.each(t,function(t,e){"object"!==e?o.push(t):_.each(t,function(t){o.push([t])})}),o=_.reject(o,function(t){return 0===t.length}),_.each(o,function(t){n=n.then(function(){return s.runImport(t,e)})})},s.runImport=function(t,e){return a.ajax({type:"POST",url:ajaxurl,data:{action:"astoundify_ci_iterate_item",iterate_action:e,items:t},dataType:"json",success:function(t){!1!==t.success&&_.each(t,function(t,e){var n=t.item.type,o=parseInt(s.typeElement(n,"total").text()),r=parseInt(s.typeElement(n,"processed").text());if(s.typeElement(n,"processed").text(r+1),r=parseInt(s.typeElement(n,"processed").text()),!1===t.success&&a("#import-errors").show().prepend("<li>"+t.data+"</li>"),r===o){s.typeElement(n,"spinner").removeClass("is-active");var i=!0;a(".import-type").each(function(t,e){parseInt(a(this).find(".processed-count").text())!==parseInt(a(this).find(".total-count").text())&&(i=!1)}),!0===i&&(s.importRunning=!1)}})},error:function(t,e,n){window.console&&console.log(e+": "+n)}})},s.typeElement=function(t,e){return a("#"+t+"-"+e)},e.bind("beforeunload",s.beforeUnload),jQuery(document).ready(function(n){s.$div.find("a.button-import").on("click",function(t){t.preventDefault();var e=n(this);return n.ajax({type:"POST",url:ajaxurl,data:{action:"astoundify_ci",security:astoundifyContentImporter.nonces.stage,page:astoundifyContentImporter.page,files:astoundifyContentImporterFiles,pack:n("input[name=astoundify_ci_pack]").val()},dataType:"json",success:function(t){t.success?(n("#plugins-to-import").hide(),n("#import-summary").slideDown("slow"),groups=t.data.groups,items=t.data.items,s.stageImport(groups),s.runIterateImport(groups,e.data("action"))):(n("#plugins-to-import").hide(),n("#import-errors").show().html("<li>"+t.data+"</li>"))}})})})}(jQuery,window.wp);
//# sourceMappingURL=content-importer.min.js.map
